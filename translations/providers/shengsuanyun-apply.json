{
  "file": "src/commands/auth-choice.apply.api-providers.ts",
  "description": "胜算云认证流程 - 在 together-api-key 之前插入胜算云处理逻辑",
  "replacements": {
    "  applyXiaomiProviderConfig,\n  applyZaiConfig,": "  applyXiaomiProviderConfig,\n  applyShengsuanyunConfig,\n  applyShengsuanyunProviderConfig,\n  applyZaiConfig,",
    "setTogetherApiKey,": "setShengSuanYunApiKey,\n  setTogetherApiKey,",
    "  if (authChoice === \"together-api-key\") {\n    let hasCredential = false;": "  if (authChoice === \"shengsuanyun-api-key\") {\n    const shengsuanyunDefaultModelRef = \"shengsuanyun/openai/gpt-4.1-nano\";\n    const store = ensureAuthProfileStore(params.agentDir, { allowKeychainPrompt: false });\n    const profileOrder = resolveAuthProfileOrder({ cfg: nextConfig, store, provider: \"shengsuanyun\" });\n    const existingProfileId = profileOrder.find((profileId) => Boolean(store.profiles[profileId]));\n    const existingCred = existingProfileId ? store.profiles[existingProfileId] : undefined;\n    let profileId = \"shengsuanyun:default\";\n    let hasCredential = false;\n    if (existingProfileId && existingCred?.type) { profileId = existingProfileId; hasCredential = true; }\n    if (!hasCredential && params.opts?.token && params.opts?.tokenProvider === \"shengsuanyun\") {\n      await setShengSuanYunApiKey(normalizeApiKeyInput(params.opts.token), params.agentDir);\n      hasCredential = true;\n    }\n    if (!hasCredential) {\n      await params.prompter.note([\"胜算云是国内 API 聚合平台，获取密钥: https://console.shengsuanyun.com/user/keys\"].join(\"\\n\"), \"胜算云\");\n    }\n    const envKey = resolveEnvApiKey(\"shengsuanyun\");\n    if (envKey) {\n      const useExisting = await params.prompter.confirm({ message: `使用现有的 SHENGSUANYUN_API_KEY?`, initialValue: true });\n      if (useExisting) { await setShengSuanYunApiKey(envKey.apiKey, params.agentDir); hasCredential = true; }\n    }\n    if (!hasCredential) {\n      const key = await params.prompter.text({ message: \"输入胜算云 API 密钥\", validate: validateApiKeyInput });\n      if (key) { await setShengSuanYunApiKey(normalizeApiKeyInput(key), params.agentDir); hasCredential = true; }\n    }\n    if (hasCredential) {\n      await applyShengsuanyunConfig({ config: nextConfig, setDefaultModel: params.setDefaultModel, defaultModel: shengsuanyunDefaultModelRef, applyDefaultConfig: applyShengsuanyunConfig, applyProviderConfig: applyShengsuanyunProviderConfig, noteDefault: shengsuanyunDefaultModelRef, noteAgentModel });\n      return { config: nextConfig };\n    }\n  }\n\n  if (authChoice === \"together-api-key\") {\n    let hasCredential = false;"
  }
}
